---
name: 生產環境準備
description: 專注於程式碼品質、文檔完整性和命名規範的生產就緒風格
---

# 生產環境準備指南

當回應使用者請求時，請遵循以下生產環境準備標準：

## 🎯 核心原則

### 1. 程式碼品質標準
- **零硬編碼**: 所有配置值必須使用環境變數或設計令牌
- **類型安全**: 完整的 TypeScript/Python 類型註解
- **錯誤處理**: 具體的異常類型和適當的 HTTPException
- **測試覆蓋率**: ⚠️ 當前 24%，目標 90% (需要重大測試架構改進)

### 2. 命名規範 (減少認知債務)
#### Python Backend
- 變數/函式: `clear_action_verb` (例: `validate_user_input`)
- 類別: `BusinessDomainNoun` (例: `KnowledgeValidator`)
- 常數: `BUSINESS_CONSTANT` (例: `MAX_RETRY_ATTEMPTS`)
- 檔案: `domain_purpose.py` (例: `user_validation.py`)

#### JavaScript Frontend
- 變數/函式: `verbNoun` (例: `fetchUserData`)
- 類別: `BusinessNoun` (例: `SelectionManager`)
- 檔案: `domain-action.js` (例: `practice-session.js`)

#### CSS 設計系統
- 元件: `component-name__element--modifier`
- 令牌: `--category-purpose-variant` (例: `--color-primary-main`)
- 檔案: `domain-components.css` (例: `practice-components.css`)

### 3. 文檔自洽性要求
- **API 文檔**: Pydantic 模型必須與 OpenAPI 規範一致
- **程式碼註解**: Google style docstrings，包含參數、返回值、異常說明
- **變更日誌**: 每次重要變更都要更新相關文檔
- **架構文檔**: 程式碼變更必須反映在架構說明中

## 📋 生產就緒檢查清單

### 程式碼品質檢查
- [ ] 通過 `ruff check .` 靜態分析
- [ ] 通過 `ruff format .` 格式化檢查
- [ ] 所有測試通過 `pytest`
- [ ] 類型檢查通過 (mypy 或 TypeScript)
- [ ] 無安全漏洞 (bandit 掃描)

### 命名清晰度檢查
- [ ] 變數名稱表達明確意圖 (動詞+名詞組合)
- [ ] 函式名稱描述具體行為 (避免模糊動詞如 `process`, `handle`)
- [ ] 檔案名稱反映業務領域 (避免技術術語如 `utils`, `helpers`)
- [ ] 類別名稱使用業務詞彙 (避免技術實作細節)

### 文檔完整性檢查
- [ ] 所有公開 API 有完整的 docstring
- [ ] 複雜業務邏輯有內聯註解說明
- [ ] 配置變數有清楚的說明和預設值
- [ ] 錯誤訊息提供明確的解決方案指引

### 架構一致性檢查
- [ ] 遵循 Linker 專案的 async 架構模式
- [ ] 使用 AsyncKnowledgeService 服務層
- [ ] CSS 使用設計令牌系統 (零硬編碼)
- [ ] API 路由使用適當的依賴注入

## 🔍 生產環境特定要求

### 效能與可擴展性
- 資料庫查詢必須有適當索引
- 快取策略要有明確的 TTL 設定
- 異步操作要有適當的並發控制
- 記憶體使用要有邊界限制

### 安全性
- 所有使用者輸入必須驗證和淨化
- API 金鑰和敏感資料使用環境變數
- CORS 設定要適合生產環境
- 錯誤訊息不能洩露系統內部資訊

### 監控與除錯
- 關鍵業務流程要有日誌記錄
- 錯誤要有適當的錯誤碼和追蹤資訊
- 效能敏感的操作要有計時記錄
- 系統健康檢查端點要完整

## 📝 回應格式要求

### 程式碼變更回應
1. **變更摘要**: 簡潔描述變更內容和原因
2. **影響分析**: 說明對系統其他部分的影響
3. **測試策略**: 說明如何驗證變更正確性
4. **部署注意事項**: 生產環境部署時的特殊考量

### 命名決策說明
- 解釋命名選擇的業務邏輯
- 說明如何減少認知負擔
- 提供替代命名方案的比較

### 文檔更新確認
- 確認相關文檔已同步更新
- 驗證文檔的自洽性和完整性
- 提供文檔品質檢查結果

## ⚡ 執行優先順序

1. **正確性**: 功能必須完全符合需求
2. **可讀性**: 程式碼和文檔必須清晰易懂
3. **可維護性**: 未來修改時的認知負擔要最小
4. **效能**: 在滿足前三點的前提下優化效能
5. **一致性**: 與現有系統架構和風格保持一致

記住：生產環境的程式碼不只是能運行，還要能被團隊長期維護和擴展。每一行程式碼、每一個命名、每一段文檔都要考慮未來維護者的認知負擔。