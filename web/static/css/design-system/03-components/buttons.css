/* ================================================
   組件 - 按鈕系統
   ================================================ */

:root {
  /* ========== Button Dimensions ========== */
  --btn-height-sm: 32px;
  --btn-height-md: 40px;
  --btn-height-lg: 48px;
  
  /* ========== Button Padding ========== */
  --btn-padding-sm: 0 var(--space-4);
  --btn-padding-md: 0 var(--space-5);
  --btn-padding-lg: 0 var(--space-8);
  
  /* ========== Button Gaps ========== */
  --btn-gap-sm: var(--space-1);
  --btn-gap-md: var(--space-2);
  --btn-gap-lg: var(--space-3);
  
  /* ========== Button Typography ========== */
  --btn-font-sm: var(--text-xs);
  --btn-font-md: var(--text-sm);
  --btn-font-lg: var(--text-base);
  --btn-line-height: 1;
  
  /* ========== Button Shadows ========== */
  --btn-shadow-focus: var(--shadow-focus);
}

/* ========== 基礎按鈕 ========== */
.btn {
  /* 結構 */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--btn-gap-md);
  position: relative;
  
  /* 尺寸 - 預設 medium */
  height: var(--btn-height-md);
  padding: var(--btn-padding-md);
  min-width: 64px; /* 中等按鈕最小寬度 */
  
  /* 文字 */
  font-family: var(--font-sans);
  font-size: var(--btn-font-md);
  font-weight: var(--font-medium);
  line-height: var(--btn-line-height);
  letter-spacing: 0;
  text-decoration: none;
  white-space: nowrap;
  
  /* Simplified visual */
  background: var(--gray-100);
  color: var(--text-primary);
  border: none;
  border-radius: var(--radius-lg);
  
  /* 互動 */
  cursor: pointer;
  transition: all var(--duration-fast) ease;
  user-select: none;
  -webkit-user-select: none;
  outline: none;
  
  /* 防止按鈕內容換行 */
  flex-shrink: 0;
}

/* Hover 狀態 */
.btn:hover:not(:disabled):not([data-loading="true"]) {
  transform: translateY(-1px);
}

/* Active 狀態 */
.btn:active:not(:disabled):not([data-loading="true"]) {
  transform: translateY(0);
}

/* Focus 狀態 */
.btn:focus-visible {
  box-shadow: var(--btn-shadow-focus);
}

/* Disabled 狀態 */
.btn:disabled,
.btn[data-disabled="true"] {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

/* ========== 變體系統 ========== */

/* Primary - 主要操作 */
.btn[data-variant="primary"] {
  background: var(--text-primary);
  color: var(--text-inverse);
  border: none;
}

.btn[data-variant="primary"]:hover:not(:disabled) {
  background: var(--gray-800);
  box-shadow: var(--shadow-lg);
}

.btn[data-variant="primary"]:active:not(:disabled) {
  background: var(--gray-900);
}

/* Secondary - 次要操作 */
.btn[data-variant="secondary"] {
  background: transparent;
  color: var(--text-primary);
  border: 1px solid var(--border-light);
}

.btn[data-variant="secondary"]:hover:not(:disabled) {
  background: var(--gray-50);
  border-color: var(--border-default);
}

/* Ghost - 輕量操作 */
.btn[data-variant="ghost"] {
  background: transparent;
  color: var(--text-secondary);  /* Changed from muted to secondary for better contrast */
  border: none;
}

.btn[data-variant="ghost"]:hover:not(:disabled) {
  background: var(--gray-100);
  color: var(--text-primary);
}

/* Success - 成功操作 */
.btn[data-variant="success"] {
  background: var(--success);
  color: var(--text-inverse);
  border-color: var(--success);
}

.btn[data-variant="success"]:hover:not(:disabled) {
  background: var(--success-hover);
  border-color: var(--success-hover);
}

/* Danger - 危險操作 */
.btn[data-variant="danger"] {
  background: var(--error);
  color: var(--text-inverse);
  border-color: var(--error);
}

.btn[data-variant="danger"]:hover:not(:disabled) {
  background: var(--error-hover);
  border-color: var(--error-hover);
}

/* Tab - 標籤式按鈕 */
.btn[data-variant="tab"] {
  background: transparent;
  color: var(--text-muted);
  border: none;
  border-radius: var(--radius-lg);
  font-weight: var(--font-medium);
}

.btn[data-variant="tab"]:hover:not(:disabled) {
  background: var(--gray-100);
  color: var(--text-secondary);
}

.btn[data-variant="tab"].active,
.btn[data-variant="tab"][data-active="true"] {
  background: var(--text-primary);
  color: var(--text-inverse);
  box-shadow: var(--shadow-md);
}

/* Card - 卡片式按鈕 */
.btn[data-variant="card"] {
  background: transparent;
  border: none;
  border-radius: var(--radius-lg);
  padding: var(--space-3) var(--space-4);
  height: auto;
  min-height: 60px; /* 卡片按鈕最小高度 */
  flex-direction: column;
  text-align: center;
  gap: var(--space-1);
  width: 100%;
  max-width: 180px; /* 卡片按鈕最大寬度 */
  transition: all var(--duration-normal) ease;
}

.btn[data-variant="card"]:hover:not(:disabled) {
  background: var(--surface-base);
  box-shadow: var(--shadow-sm);
}

.btn[data-variant="card"].active,
.btn[data-variant="card"][data-active="true"] {
  background: var(--surface-base);
  box-shadow: var(--shadow-sm);
}

/* Icon - 圖標按鈕 */
.btn[data-variant="icon"] {
  width: var(--space-8);
  height: var(--space-8);
  padding: 0;
  min-width: unset;
  border-radius: var(--radius);
  background: transparent;
  border: none;
}

.btn[data-variant="icon"]:hover:not(:disabled) {
  background: var(--gray-100);
  color: var(--text-primary);
}

/* Gradient - 漸變按鈕 */
.btn[data-variant="gradient"] {
  background: var(--accent-600);
  color: var(--text-inverse);
  border: none;
}

.btn[data-variant="gradient"]:hover:not(:disabled) {
  background: var(--accent-700);
  box-shadow: var(--shadow-primary);
}

/* Filter Tab - 篩選標籤（如錯誤類別、句型分類） */
.btn[data-variant="filter-tab"] {
  background: var(--surface-base);
  color: var(--text-muted);
  border: 1px solid var(--border-light);
  border-radius: var(--radius-lg);
  font-weight: var(--font-medium);
  transition: all var(--duration-normal) ease;
  padding: var(--space-2) var(--space-4);
  min-width: auto;
  cursor: pointer;
}

.btn[data-variant="filter-tab"]:hover:not(:disabled) {
  background: var(--gray-100);
  border-color: var(--border-default);
  color: var(--text-primary);
  transform: translateY(0);
}

.btn[data-variant="filter-tab"].active,
.btn[data-variant="filter-tab"][data-active="true"],
.btn[data-variant="filter-tab"].active:hover,
.btn[data-variant="filter-tab"][data-active="true"]:hover {
  background: var(--gray-900);
  color: var(--text-inverse);
  border-color: var(--gray-900);
  box-shadow: var(--shadow-lg);
  font-weight: var(--font-semibold);
  transform: translateY(0);
}

/* Filter Pill - 篩選藥丸（如掌握度、難度） */
.btn[data-variant="filter-pill"] {
  background: var(--surface-base);
  color: var(--text-muted);
  border: 1px solid var(--border-light);
  border-radius: var(--radius-full);
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  transition: all var(--duration-normal) ease;
  min-width: auto;
  height: auto;
  cursor: pointer;
}

.btn[data-variant="filter-pill"]:hover:not(:disabled) {
  background: var(--gray-100);
  border-color: var(--border-default);
  color: var(--text-primary);
  transform: translateY(0);
}

.btn[data-variant="filter-pill"].active,
.btn[data-variant="filter-pill"][data-active="true"],
.btn[data-variant="filter-pill"].active:hover,
.btn[data-variant="filter-pill"][data-active="true"]:hover {
  background: var(--accent);
  color: var(--text-inverse);
  border-color: var(--accent);
  box-shadow: var(--shadow-primary-lg);
  font-weight: var(--font-semibold);
  transform: translateY(0);
}

/* 篩選按鈕內的計數標籤 */
.btn[data-variant="filter-tab"] .btn-count,
.btn[data-variant="filter-pill"] .btn-count {
  margin-left: var(--space-2);
  padding: 0 var(--space-2);
  background: rgba(0, 0, 0, 0.1);
  border-radius: var(--radius-full);
  font-size: var(--text-xs);
  font-weight: var(--font-semibold);
}

.btn[data-variant="filter-tab"].active .btn-count,
.btn[data-variant="filter-pill"].active .btn-count {
  background: rgba(255, 255, 255, 0.2);
}

/* ========== 尺寸系統 ========== */

/* Small */
.btn[data-size="sm"] {
  height: var(--btn-height-sm);
  padding: var(--btn-padding-sm);
  font-size: var(--btn-font-sm);
  gap: var(--btn-gap-sm);
  min-width: 48px; /* 小按鈕最小寬度 */
}

.btn[data-size="sm"][data-variant="icon"] {
  width: var(--btn-height-sm);
  height: var(--btn-height-sm);
}

/* Large */
.btn[data-size="lg"] {
  height: var(--btn-height-lg);
  padding: var(--btn-padding-lg);
  font-size: var(--btn-font-lg);
  gap: var(--btn-gap-lg);
  min-width: 80px; /* 大按鈕最小寬度 */
}

.btn[data-size="lg"][data-variant="icon"] {
  width: var(--btn-height-lg);
  height: var(--btn-height-lg);
}

/* ========== 狀態系統 ========== */

/* Loading 狀態 */
.btn[data-loading="true"] {
  color: transparent;
  pointer-events: none;
  position: relative;
}

.btn[data-loading="true"]::after {
  content: '';
  position: absolute;
  width: var(--space-4);
  height: var(--space-4);
  top: 50%;
  left: 50%;
  margin: calc(var(--space-2) * -1) 0 0 calc(var(--space-2) * -1);
  border: var(--space-0-25) solid currentColor; /* loading 指示器邊框 */
  border-top-color: transparent;
  border-radius: 50%;
  animation: var(--animation-spin);
}

/* Loading 狀態 - 根據變體調整顏色 */
.btn[data-variant="primary"][data-loading="true"]::after,
.btn[data-variant="success"][data-loading="true"]::after,
.btn[data-variant="danger"][data-loading="true"]::after {
  border-color: var(--text-inverse);
  border-top-color: transparent;
}

/* Full Width */
.btn[data-full="true"] {
  width: 100%;
  max-width: none;
}

/* ========== 特殊元素 ========== */

/* 卡片按鈕的標題和描述 */
.btn[data-variant="card"] .btn-title {
  font-size: var(--text-lg);
  font-weight: var(--font-semibold);
  color: var(--text-primary);
  display: block;
}

.btn[data-variant="card"] .btn-desc {
  font-size: var(--text-sm);
  color: var(--text-muted);
  font-weight: var(--font-normal);
  display: block;
}

/* 標籤按鈕的計數器 */
.btn[data-variant="tab"] .btn-count,
.btn[data-variant="tab"] .badge {
  background: rgba(255, 255, 255, 0.2);
  padding: var(--space-0-25) var(--space-2); /* 計數器小內間 */
  border-radius: var(--radius-full);
  font-size: var(--text-xs);
  font-weight: var(--font-semibold);
  min-width: var(--space-5); /* 計數器最小寬度 */
  text-align: center;
  margin-left: var(--space-2);
}

.btn[data-variant="tab"].active .btn-count,
.btn[data-variant="tab"][data-active="true"] .badge {
  background: rgba(255, 255, 255, 0.3);
}

/* ========== 動畫定義 ========== */

/* ========== 響應式 ========== */
@media (max-width: 768px) {
  .btn {
    font-size: var(--text-sm);
  }
  
  .btn[data-variant="card"] {
    max-width: 100%;
  }
}

/* ========== 無障礙優化 ========== */
@media (prefers-reduced-motion: reduce) {
  .btn {
    transition: none;
  }
  
  .btn:hover {
    transform: none;
  }
  
  .btn[data-loading="true"]::after {
    animation: none;
    border: var(--space-0-25) solid currentColor; /* 無障礙模式 loading 指示器 */
    opacity: 0.5;
  }
}

/* ========== 兼容性處理 ========== */
/* 保留舊類名的基本支援（過渡期） */
.btn.primary {
  background: var(--primary);
  color: var(--text-inverse);
  border-color: var(--primary);
}

.btn.outline {
  background: var(--surface-base);
  color: var(--text-primary);
  border-color: var(--border-default);
}

.btn.large {
  height: var(--btn-height-lg);
  padding: var(--btn-padding-lg);
  font-size: var(--btn-font-lg);
}

.btn.small {
  height: var(--btn-height-sm);
  padding: var(--btn-padding-sm);
  font-size: var(--btn-font-sm);
}

/* ========== 深色模式 ========== */
@media (prefers-color-scheme: dark) {
  .btn {
    background: var(--surface-elevated);
    color: var(--text-primary);
    border-color: var(--border-dark);
  }
  
  .btn:hover:not(:disabled):not([data-loading="true"]) {
    background: var(--surface-base);
    border-color: var(--border-focus);
  }
  
  .btn[data-variant="primary"] {
    background: var(--primary);
    color: var(--text-inverse);
  }
  
  .btn[data-variant="primary"]:hover:not(:disabled) {
    background: var(--primary-hover);
  }
  
  .btn[data-variant="secondary"] {
    background: transparent;
    color: var(--text-primary);
    border-color: var(--border-dark);
  }
  
  .btn[data-variant="secondary"]:hover:not(:disabled) {
    background: var(--surface-elevated);
    border-color: var(--border-focus);
  }
  
  .btn[data-variant="ghost"] {
    color: var(--text-secondary);
  }
  
  .btn[data-variant="ghost"]:hover:not(:disabled) {
    background: var(--surface-elevated);
    color: var(--text-primary);
  }
  
  .btn[data-variant="tab"] {
    color: var(--text-secondary);
  }
  
  .btn[data-variant="tab"]:hover:not(:disabled) {
    background: var(--surface-elevated);
    color: var(--text-primary);
  }
  
  .btn[data-variant="tab"].active,
  .btn[data-variant="tab"][data-active="true"] {
    background: var(--primary);
    color: var(--text-inverse);
  }
  
  .btn[data-variant="card"]:hover:not(:disabled) {
    background: var(--surface-elevated);
  }
  
  .btn[data-variant="card"].active,
  .btn[data-variant="card"][data-active="true"] {
    background: var(--surface-elevated);
  }
  
  .btn[data-variant="icon"]:hover:not(:disabled) {
    background: var(--surface-elevated);
    color: var(--text-primary);
  }
}