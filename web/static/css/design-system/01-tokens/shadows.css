/* ===================================================
   設計令牌 - 陰影系統 V2 (統一架構)
   三層設計：原始值 → 組合 → 語義
   =================================================== */

/* ========== Layer 1: 原始值層 (Primitives) ========== */
:root {
  /* 陰影顏色基礎值 - RGB 三元組格式 */
  --shadow-rgb: 0 0 0;
  --shadow-rgb-primary: 79 70 229;    /* Indigo-600 */
  --shadow-rgb-success: 16 185 129;   /* Emerald-500 */
  --shadow-rgb-warning: 245 158 11;   /* Amber-500 */
  --shadow-rgb-error: 239 68 68;      /* Red-500 */
  
  /* 陰影透明度級別 - 完整系統（覆蓋所有硬編碼值） */
  --shadow-alpha-1: 0.02;     /* 極淺 */
  --shadow-alpha-1-5: 0.04;   /* 對應硬編碼 0.04 */
  --shadow-alpha-2: 0.05;     /* 對應硬編碼 0.05 */
  --shadow-alpha-2-5: 0.06;   /* 對應硬編碼 0.06 */
  --shadow-alpha-3: 0.07;     /* 對應硬編碼 0.07 */
  --shadow-alpha-4: 0.08;     /* 對應硬編碼 0.08 */
  --shadow-alpha-5: 0.10;     /* 對應硬編碼 0.1 */
  --shadow-alpha-6: 0.12;     /* 中深 */
  --shadow-alpha-7: 0.15;     /* 對應硬編碼 0.15 */
  --shadow-alpha-8: 0.20;     /* 對應硬編碼 0.2 */
  
  /* 陰影幾何參數 */
  --shadow-offset-xs: 1px;
  --shadow-offset-sm: 2px;
  --shadow-offset-md: 4px;
  --shadow-offset-lg: 8px;
  --shadow-offset-xl: 12px;
  
  --shadow-blur-xs: 2px;
  --shadow-blur-sm: 4px;
  --shadow-blur-md: 8px;
  --shadow-blur-lg: 16px;
  --shadow-blur-xl: 24px;
  --shadow-blur-2xl: 32px;
  
  --shadow-spread-none: 0;
  --shadow-spread-tight: -1px;
  --shadow-spread-normal: 0;
  --shadow-spread-wide: 1px;
}

/* ========== Layer 2: 組合層 (Compositions) ========== */
:root {
  /* 標準陰影系列 - 精確對應硬編碼值 */
  --shadow-xs: 0 var(--shadow-offset-xs) var(--shadow-blur-xs) rgb(var(--shadow-rgb) / var(--shadow-alpha-2));
  --shadow-sm: 0 var(--shadow-offset-sm) var(--shadow-blur-sm) rgb(var(--shadow-rgb) / var(--shadow-alpha-4));
  --shadow-md: 0 var(--shadow-offset-md) var(--shadow-blur-md) rgb(var(--shadow-rgb) / var(--shadow-alpha-5));
  --shadow-lg: 0 var(--shadow-offset-lg) var(--shadow-blur-lg) rgb(var(--shadow-rgb) / var(--shadow-alpha-7));
  --shadow-xl: 0 var(--shadow-offset-xl) var(--shadow-blur-xl) rgb(var(--shadow-rgb) / var(--shadow-alpha-8));
  --shadow-2xl: 0 16px var(--shadow-blur-2xl) rgb(var(--shadow-rgb) / var(--shadow-alpha-8));
  
  /* 補充常用陰影尺寸 */
  --shadow-2xs: 0 1px 2px rgb(var(--shadow-rgb) / var(--shadow-alpha-1-5));
  --shadow-3xs: 0 1px 1px rgb(var(--shadow-rgb) / var(--shadow-alpha-2));
  
  /* 複合陰影 - 精確對應專案中的複合陰影 */
  --shadow-elevated-xs: 
    0 1px 2px rgb(var(--shadow-rgb) / var(--shadow-alpha-2)),
    0 1px 1px rgb(var(--shadow-rgb) / var(--shadow-alpha-1));
    
  --shadow-elevated-sm: 
    0 1px 3px 0 rgb(var(--shadow-rgb) / var(--shadow-alpha-5)),
    0 1px 2px 0 rgb(var(--shadow-rgb) / var(--shadow-alpha-2-5));
    
  --shadow-elevated-md: 
    0 4px 6px -1px rgb(var(--shadow-rgb) / var(--shadow-alpha-3)),
    0 2px 4px -1px rgb(var(--shadow-rgb) / var(--shadow-alpha-1-5));
    
  --shadow-elevated-lg: 
    0 10px 15px -3px rgb(var(--shadow-rgb) / var(--shadow-alpha-5)),
    0 4px 6px -2px rgb(var(--shadow-rgb) / var(--shadow-alpha-2-5));
    
  --shadow-elevated-xl: 
    0 10px 25px -5px rgb(var(--shadow-rgb) / var(--shadow-alpha-5)),
    0 10px 10px -5px rgb(var(--shadow-rgb) / var(--shadow-alpha-1-5));
    
  --shadow-elevated-2xl: 
    0 20px 25px -5px rgb(var(--shadow-rgb) / var(--shadow-alpha-7)),
    0 10px 10px -5px rgb(var(--shadow-rgb) / var(--shadow-alpha-1));
  
  /* 內陰影系列 - 對應專案中的內陰影 */
  --shadow-inner-xs: inset 0 1px 2px rgb(var(--shadow-rgb) / var(--shadow-alpha-2));
  --shadow-inner-sm: inset 0 2px 4px rgb(var(--shadow-rgb) / var(--shadow-alpha-2-5));
  --shadow-inner-md: inset 0 2px 4px 0 rgb(var(--shadow-rgb) / var(--shadow-alpha-2));
  --shadow-inner-lg: inset 0 4px 8px rgb(var(--shadow-rgb) / var(--shadow-alpha-5));
  
  /* 彩色陰影 - 精確對應專案中使用的彩色陰影 */
  --shadow-primary: 0 2px 8px rgb(var(--shadow-rgb-primary) / 0.25);
  --shadow-primary-lg: 0 4px 12px rgb(var(--shadow-rgb-primary) / 0.3);
  --shadow-accent-lg: 0 4px 12px rgb(var(--shadow-rgb-primary) / 0.3);  /* Alias for primary */
  --shadow-success: 0 4px 12px rgb(var(--shadow-rgb-success) / 0.25);
  --shadow-success-light: 0 4px 6px -1px rgb(var(--shadow-rgb-success) / 0.1);
  --shadow-success-heavy: 0 10px 15px -3px rgb(var(--shadow-rgb-success) / 0.15);
  --shadow-warning: 0 4px 12px rgb(var(--shadow-rgb-warning) / 0.25);
  --shadow-error: 0 4px 12px rgb(var(--shadow-rgb-error) / 0.25);
  
  /* 專案中的額外彩色陰影 */
  --shadow-rgb-purple: 99 102 241;   /* Violet-500 對應 rgba(99, 102, 241, x) */
  --shadow-rgb-green-alt: 76 175 80; /* Green-500 對應 rgba(76, 175, 80, x) */
  --shadow-rgb-blue: 33 150 243;     /* Blue-500 對應 rgba(33, 150, 243, x) */
  
  --shadow-purple-light: 0 4px 6px -1px rgb(var(--shadow-rgb-purple) / 0.1);
  --shadow-green-alt: 0 4px 6px -1px rgb(var(--shadow-rgb-green-alt) / 0.2);
  --shadow-blue: 0 4px 6px -1px rgb(var(--shadow-rgb-blue) / 0.2);
  
  /* 特殊效果陰影 */
}

/* ========== Layer 3: 語義層 (Semantic) ========== */
:root {
  /* 組件專用陰影 - 基礎組件 */
  --shadow-card: var(--shadow-sm);
  --shadow-card-hover: var(--shadow-elevated-md);
  --shadow-card-active: var(--shadow-elevated-sm);
  --shadow-card-complex: var(--shadow-elevated-sm);
  
  --shadow-button: var(--shadow-xs);
  --shadow-button-hover: var(--shadow-sm);
  --shadow-button-active: var(--shadow-inner-sm);
  --shadow-button-heavy: var(--shadow-lg);
  --shadow-button-primary: var(--shadow-primary);
  --shadow-button-primary-hover: var(--shadow-primary-lg);
  
  /* 覆蓋層陰影 */
  --shadow-modal: var(--shadow-elevated-xl);
  --shadow-modal-complex: var(--shadow-elevated-2xl);
  --shadow-dropdown: var(--shadow-elevated-lg);
  
  /* 表單元素陰影 */
  --shadow-input: var(--shadow-xs);
  --shadow-input-hover: var(--shadow-sm);
  --shadow-input-focus: var(--shadow-focus);
  
  /* 交互狀態陰影 - 精確對應專案中的焦點陰影 */
  --shadow-focus: 0 0 0 3px rgb(var(--shadow-rgb-primary) / 0.2);
  --shadow-focus-accent: 0 0 0 3px rgb(var(--shadow-rgb-primary) / 0.2);  /* Alias for focus */
  --shadow-focus-light: 0 0 0 3px rgb(var(--shadow-rgb-primary) / 0.1);
  --shadow-focus-error: 0 0 0 3px rgb(var(--shadow-rgb-error) / 0.2);
  --shadow-focus-success: 0 0 0 3px rgb(var(--shadow-rgb-success) / 0.2);
  --shadow-focus-warning: 0 0 0 3px rgb(var(--shadow-rgb-warning) / 0.2);
  --shadow-focus-purple: 0 0 0 3px rgb(var(--shadow-rgb-purple) / 0.1);
  --shadow-focus-blue: 0 0 0 3px rgb(var(--shadow-rgb-blue) / 0.2);
  --shadow-focus-green: 0 0 0 3px rgb(var(--shadow-rgb-green-alt) / 0.2);
  
  /* 高程陰影 - Material Design 風格 */
  --shadow-elevation-1: var(--shadow-elevated-xs);
  --shadow-elevation-2: var(--shadow-elevated-sm);
  --shadow-elevation-3: var(--shadow-elevated-md);
  --shadow-elevation-4: var(--shadow-elevated-lg);
  --shadow-elevation-5: var(--shadow-elevated-xl);
  
  /* 特殊用途陰影 */
  --shadow-glass: 0 8px 32px rgb(var(--shadow-rgb) / 0.12);
  --shadow-text: 0 1px 2px rgb(var(--shadow-rgb) / 0.1);
  --shadow-image: 0 4px 8px rgb(var(--shadow-rgb) / 0.15);
  
  /* 狀態特定陰影 */
  --shadow-success-state: var(--shadow-success-light);
  --shadow-error-state: var(--shadow-error);
  --shadow-warning-state: var(--shadow-warning);
  
  /* 專案特定語義陰影 */
  --shadow-knowledge-card: var(--shadow-card);
  --shadow-practice-item: var(--shadow-sm);
  --shadow-pattern-card: var(--shadow-xs);
  --shadow-modal-overlay: var(--shadow-modal-complex);
}

/* ========== 響應式和主題適配 ========== */

/* 深色模式適配 */
@media (prefers-color-scheme: dark) {
  :root {
    /* 深色模式下增強陰影強度 */
    --shadow-alpha-1: 0.05;
    --shadow-alpha-2: 0.08;
    --shadow-alpha-3: 0.10;
    --shadow-alpha-4: 0.12;
    --shadow-alpha-5: 0.15;
    --shadow-alpha-6: 0.18;
    --shadow-alpha-7: 0.22;
    --shadow-alpha-8: 0.25;
    
  }
}

/* 高對比度模式 */
@media (prefers-contrast: high) {
  :root {
    --shadow-alpha-4: 0.15;
    --shadow-alpha-5: 0.20;
    --shadow-alpha-6: 0.25;
  }
}

/* 減少動畫偏好 */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: box-shadow 0.01ms !important;
  }
}

/* 打印模式 */
@media print {
  :root {
    --shadow-xs: none;
    --shadow-sm: none;
    --shadow-md: none;
    --shadow-lg: none;
    --shadow-xl: none;
    --shadow-2xl: none;
    --shadow-card: none;
    --shadow-modal: none;
  }
}

/* ========== 實用工具類 ========== */

/* 陰影實用類 */
.shadow-none { box-shadow: none !important; }
.shadow-xs { box-shadow: var(--shadow-xs); }
.shadow-sm { box-shadow: var(--shadow-sm); }
.shadow-md { box-shadow: var(--shadow-md); }
.shadow-lg { box-shadow: var(--shadow-lg); }
.shadow-xl { box-shadow: var(--shadow-xl); }
.shadow-2xl { box-shadow: var(--shadow-2xl); }

/* 語義陰影類 */
.shadow-card { box-shadow: var(--shadow-card); }
.shadow-button { box-shadow: var(--shadow-button); }
.shadow-modal { box-shadow: var(--shadow-modal); }

/* 性能優化 */
.shadow-optimized {
  will-change: box-shadow;
  contain: layout style;
}

/* 陰影過渡 */
.shadow-transition {
  transition: box-shadow var(--duration-normal) ease;
}

.shadow-transition-fast {
  transition: box-shadow var(--duration-fast) ease;
}

.shadow-transition-slow {
  transition: box-shadow var(--duration-normal) ease;
}

/* ========== 開發輔助 ========== */

/* Debug 模式 - 顯示所有陰影級別 */
.debug-shadows .shadow-xs::after { content: 'XS'; }
.debug-shadows .shadow-sm::after { content: 'SM'; }
.debug-shadows .shadow-md::after { content: 'MD'; }
.debug-shadows .shadow-lg::after { content: 'LG'; }
.debug-shadows .shadow-xl::after { content: 'XL'; }

/* 文檔註釋
 * 
 * 使用指南：
 * 1. 優先使用語義變數（--shadow-card, --shadow-button）
 * 2. 組件內部使用標準變數（--shadow-sm, --shadow-md）
 * 3. 避免直接使用原始值變數
 * 4. 使用實用類進行快速原型設計
 * 
 * 性能建議：
 * 1. 為動畫元素添加 .shadow-optimized 類
 * 2. 使用 .shadow-transition 進行平滑過渡
 * 3. 避免在循環中修改陰影
 * 
 * 瀏覽器支援：
 * - 現代瀏覽器：完全支援
 * - IE11：需要 rgba() fallback
 * - Safari < 14：需要 webkit 前綴
 */