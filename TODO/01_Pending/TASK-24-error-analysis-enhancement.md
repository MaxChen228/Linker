# TASK-24: 錯誤分析系統增強

- **Priority**: 🟠 HIGH  
- **Estimated Time**: 4-5 hours
- **Related Components**: core/ai_service.py, web/routers/api_practice.py
- **Discovery Date**: 2025-08-15

---

### 🎯 Task Objective
增強錯誤分析系統的功能，提供更好的學習體驗和錯誤追蹤。

### 📝 測試中的發現

#### 錯誤類型分類
系統目前能識別的錯誤類型：
1. **名詞片語錯誤**：如 `lack money` → `a lack of sufficient funds`
2. **動詞結構錯誤**：如 `has been become` → `has been suspended`
3. **語意理解錯誤**：完全誤解原文意思
4. **介詞使用錯誤**：如 `Because of` vs `Due to`

#### 評分機制觀察
- 100%：完全正確
- 77%：1-2 個小錯誤
- 54%：3-4 個錯誤或有嚴重理解錯誤
- 評分似乎基於錯誤數量和嚴重程度的加權計算

### 🔍 改進建議

#### 1. 錯誤統計和追蹤
- **需求**：統計用戶常犯的錯誤類型
- **實現**：
  ```python
  error_stats = {
      "grammar_errors": {"count": 0, "examples": []},
      "vocabulary_errors": {"count": 0, "examples": []},
      "comprehension_errors": {"count": 0, "examples": []}
  }
  ```
- **價值**：幫助用戶了解自己的弱點

#### 2. 個性化錯誤回饋
- **需求**：根據用戶的錯誤歷史提供針對性建議
- **實現**：
  - 記錄每個用戶的錯誤模式
  - 生成個性化的學習建議
  - 推薦相關的練習題目

#### 3. 錯誤嚴重程度分級
- **需求**：明確定義錯誤嚴重程度
- **建議分級**：
  - 🔴 嚴重（-30%）：完全誤解意思
  - 🟠 中等（-15%）：語法結構錯誤
  - 🟡 輕微（-8%）：詞彙選擇不當
  - 🟢 細微（-3%）：標點或大小寫

#### 4. 學習進度追蹤
- **需求**：追蹤用戶在特定錯誤類型上的改進
- **實現**：
  - 建立錯誤改進曲線圖
  - 顯示過去 30 天的進步情況
  - 設定學習里程碑

### ✅ Acceptance Criteria
- [ ] 系統能統計和分類所有錯誤
- [ ] 用戶可以查看自己的錯誤統計報告
- [ ] 評分機制有明確的計算規則文檔
- [ ] 系統能根據錯誤歷史推薦練習

### 💡 技術實現要點
1. 在資料庫中添加 `error_logs` 表
2. 使用 AI 進行錯誤模式分析
3. 建立錯誤類型的標準分類體系
4. 實現錯誤統計的 API 端點

### 📝 Execution Notes
- 優先實現錯誤統計功能
- 考慮使用圖表庫（如 Chart.js）視覺化錯誤數據
- 確保用戶隱私，錯誤數據應該匿名化處理